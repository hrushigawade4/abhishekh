<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Dashboard | Abhishek Manager</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
  <div class="container">
    <h2>📊 Dashboard</h2>
    <p>Total Bhakts: <strong>{{ total }}</strong></p>

    <div style="margin-bottom: 1em;">
      <a href="{{ url_for('register') }}">➕ Register Bhakt</a> |
      <a href="{{ url_for('calendar') }}">📅 Monthly Calendar</a> |
      <a href="{{ url_for('export_csv') }}">📤 Export to CSV</a> |
      <a href="{{ url_for('logout') }}">🚪 Logout</a>
    </div>

    <form method="GET" action="{{ url_for('search') }}">
      <input type="text" name="q" placeholder="Search Bhakt by Name" required>
      <button type="submit">🔍 Search</button>
    </form>

    <div style="margin-top: 1em; font-size: 0.9em;">
      <strong>Status Legend:</strong><br>
      🟩 <span style="color: green;">Active</span> = more than 30 days left<br>
      🟨 <span style="color: orange;">Expiring Soon</span> = under 30 days<br>
      🟥 <span style="color: red;">Expired</span> = already ended
    </div>

    <table border="1" cellpadding="6" cellspacing="0" style="margin-top: 1em; width: 100%;">
      <thead>
        <tr>
          <th>ID</th>
          <th>Name</th>
          <th>Type</th>
          <th>Start Date</th>
          <th>Next Abhishek Date</th>
          <th>Status</th>
          <th>View</th>
        </tr>
      </thead>
      <tbody>
        {% for b in summary %}
        <tr style="background-color:
          {% if b[5] == 'expired' %}#ffe6e6
          {% elif b[5] == 'expiring_soon' %}#fff3cd
          {% else %}#e6ffea{% endif %};">
          <td>{{ b[0] }}</td>
          <td>{{ b[1] }}</td>
          <td>{{ b[2] }}</td>
          <td>{{ b[3] }}</td>
          <td>{{ b[4] }}</td>
          <td><strong>{{ b[5]|replace('_', ' ')|upper }}</strong></td>
          <td><a href="{{ url_for('bhakt_detail', bhakt_id=b[0]) }}">📄 Details</a></td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</body>
</html>
